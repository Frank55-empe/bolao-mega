<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bolão da Mega Positivo</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    .hidden { display: none; }
    .form-step { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { text-align: center; }
    input, select, button { width: 100%; padding: 10px; margin: 10px 0; }
    .grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 5px; }
    .dezena { background: #ddd; padding: 10px; text-align: center; border-radius: 4px; cursor: pointer; }
    .dezena.selected { background: green; color: white; }
    .counter { text-align: center; margin: 10px 0; font-weight: bold; }
  </style>
</head>
<body>

  <div id="etapa1" class="form-step">
    <h2>Bem-vindo ao Bolão da Mega</h2>
    <input type="text" id="nomeConsulta" placeholder="Digite seu nome completo">
    <button onclick="consultarParticipante()">Avançar</button>
  </div>

  <div id="escolhaExistente" class="form-step hidden">
    <h2>Cadastro encontrado</h2>
    <button onclick="irParaResumo()">1 - Manter meu jogo</button>
    <button onclick="irParaCadastro()">2 - Novo jogo</button>
  </div>

  <div id="formularioCadastro" class="form-step hidden">
    <h2>Cadastro do Participante</h2>
    <input type="text" id="nomeCompleto" placeholder="Nome Completo">
    <input type="text" id="nomeJogo" placeholder="Nome que vai no jogo">
    <input type="text" id="whatsapp" placeholder="WhatsApp">
    <input type="text" id="cidade" placeholder="Cidade">

    <div class="counter" id="contador">0 de 10 dezenas selecionadas</div>
    <div class="grid" id="dezenas"></div>

    <button id="btnConfirmarCadastro" class="hidden" onclick="mostrarResumo()">Confirmar Jogo</button>
  </div>

  <div id="resumoCadastro" class="form-step hidden">
    <h2>Confirme seus dados</h2>
    <div id="resumoDados"></div>
    <button onclick="enviarDados()">Enviar Cadastro</button>
    <button onclick="voltarParaEdicao()">Corrigir Dados</button>
  </div>

  <div id="agradecimento" class="form-step hidden">
    <h2>Cadastro enviado!</h2>
    <p>Obrigado por participar do bolão! Seu jogo está registrado.<br>
    Efetue o pagamento via Pix:<br>
    <strong>Chave Pix:</strong> 35991717912<br>
    <strong>Nome:</strong> Frank de Souza Borges</p>
    <button onclick="reiniciarCadastro()">Fazer novo cadastro</button>
  </div>

  <script>
    const dezenasSelecionadas = new Set();

    function consultarParticipante() {
      const nome = document.getElementById("nomeConsulta").value.trim();
      if (!nome) return alert("Digite o nome para continuar.");

      // Simula consulta
      if (nome.toLowerCase().includes("joão")) {
        document.getElementById("etapa1").classList.add("hidden");
        document.getElementById("escolhaExistente").classList.remove("hidden");
      } else {
        document.getElementById("etapa1").classList.add("hidden");
        irParaCadastro();
      }
    }

    function irParaCadastro() {
      document.getElementById("escolhaExistente").classList.add("hidden");
      document.getElementById("formularioCadastro").classList.remove("hidden");
      gerarDezenas();
    }

    function irParaResumo() {
      document.getElementById("escolhaExistente").classList.add("hidden");
      // Simula dados antigos
      document.getElementById("nomeCompleto").value = "João da Silva";
      document.getElementById("nomeJogo").value = "João Mega";
      document.getElementById("whatsapp").value = "(35) 99111-1111";
      document.getElementById("cidade").value = "Alfenas";
      dezenasSelecionadas.clear();
      for (let i = 1; i <= 10; i++) dezenasSelecionadas.add(i);
      document.getElementById("formularioCadastro").classList.remove("hidden");
      gerarDezenas();
      mostrarResumo();
    }

    function gerarDezenas() {
      const container = document.getElementById("dezenas");
      container.innerHTML = "";
      for (let i = 1; i <= 60; i++) {
        const dez = document.createElement("div");
        dez.textContent = String(i).padStart(2, "0");
        dez.className = "dezena";
        if (dezenasSelecionadas.has(i)) dez.classList.add("selected");
        dez.onclick = () => toggleDezena(i, dez);
        container.appendChild(dez);
      }
      atualizarContador();
    }

    function toggleDezena(n, el) {
      if (dezenasSelecionadas.has(n)) {
        dezenasSelecionadas.delete(n);
        el.classList.remove("selected");
      } else {
        if (dezenasSelecionadas.size >= 10) return;
        dezenasSelecionadas.add(n);
        el.classList.add("selected");
      }
      atualizarContador();
    }

    function atualizarContador() {
      const contador = document.getElementById("contador");
      contador.textContent = `${dezenasSelecionadas.size} de 10 dezenas selecionadas`;
      document.getElementById("btnConfirmarCadastro").classList.toggle("hidden", dezenasSelecionadas.size !== 10);
    }

    function mostrarResumo() {
      const dados = `
        <p><strong>Nome:</strong> ${document.getElementById("nomeCompleto").value}</p>
        <p><strong>Nome no Jogo:</strong> ${document.getElementById("nomeJogo").value}</p>
        <p><strong>WhatsApp:</strong> ${document.getElementById("whatsapp").value}</p>
        <p><strong>Cidade:</strong> ${document.getElementById("cidade").value}</p>
        <p><strong>Dezenas:</strong> ${[...dezenasSelecionadas].sort((a,b)=>a-b).map(n=>String(n).padStart(2,"0")).join(", ")}</p>
      `;
      document.getElementById("formularioCadastro").classList.add("hidden");
      document.getElementById("resumoDados").innerHTML = dados;
      document.getElementById("resumoCadastro").classList.remove("hidden");
    }

    function voltarParaEdicao() {
      document.getElementById("resumoCadastro").classList.add("hidden");
      document.getElementById("formularioCadastro").classList.remove("hidden");
    }

    function enviarDados() {
      const payload = {
        nomeCompleto: document.getElementById("nomeCompleto").value,
        nomeJogo: document.getElementById("nomeJogo").value,
        whatsapp: document.getElementById("whatsapp").value,
        cidade: document.getElementById("cidade").value,
        dezenas: [...dezenasSelecionadas].sort((a,b)=>a-b)
      };

      fetch("https://script.google.com/macros/s/AKfycbxct64GeIbXuCxIEnyJM8De72cRw_LBAfEftYHUXBH0amI7YaZ6h8QbsO54qxiFeDLc/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(res => res.json())
      .then(data => {
        if (data.result === "success") {
          document.getElementById("resumoCadastro").classList.add("hidden");
          document.getElementById("agradecimento").classList.remove("hidden");
        } else {
          alert("Erro ao enviar os dados. Tente novamente.");
        }
      });
    }

    function reiniciarCadastro() {
      location.reload();
    }
  </script>

</body>
</html>

  
